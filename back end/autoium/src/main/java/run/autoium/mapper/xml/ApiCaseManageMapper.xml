<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="run.autoium.mapper.ApiCaseManageMapper">

    <resultMap id="apiCasePageConditionResult" type="run.autoium.entity.vo.ApiCaseManageVo">
        <result property="name" column="name"/>
        <result property="description" column="description"/>
        <result property="gmtCreate" column="gmt_create"/>
        <result property="gmtModified" column="gmt_modified"/>
        <result property="projectName" column="pname"/>
        <result property="apiCaseSuiteName" column="sname"/>
    </resultMap>

    <select id="getApiCasePageCondition" resultMap="apiCasePageConditionResult">
        select a.name name , a.description description , a.gmt_create gmt_create , a.gmt_modified gmt_modified , p.name pname , s.name sname
        from api_case a , project p , api_case_suite s
        where a.project_id = p.id and a.api_case_suite_id = s.id
        <if test="apiCaseManageVo != null and apiCaseManageVo.name != null and apiCaseManageVo.name != '' ">
            and a.name like #{apiCaseManageVo.name}
        </if>
        <if test="apiCaseManageVo != null and apiCaseManageVo.description != null and apiCaseManageVo.description != ''">
            and a.description like #{apiCaseManageVo.descirption}
        </if>
        <if test="apiCaseManageVo != null and apiCaseManageVo.gmtCreateStart != null and apiCaseManageVo.gmtCreateStart != ''">
            and a.gmt_create &gt;= #{apiCaseManageVo.gmtCreateStart}
        </if>
        <if test="apiCaseManageVo != null and apiCaseManageVo.gmtCreateEnd != null and apiCaseManageVo.gmtCreateEnd != ''">
            and a.gmt_create &lt;= #{apiCaseManageVo.gmtCreateEnd}
        </if>
    </select>

    <select id="getById" resultMap="apiCasePageConditionResult">
        select a.name name , a.description description , a.gmt_create gmt_create , a.gmt_modified gmt_modified , p.name pname , s.name sname
        from api_case a , project p , api_case_suite s
        where a.project_id = p.id and a.api_case_suite_id = s.id and a.id = #{apiId}
    </select>

    <delete id="removeById">
        delete from api_case where id = #{apiId};
    </delete>

    <insert id="save">
        insert into api_case(id , name , project_id , api_case_suite_id , gmt_create , gmt_modified , description)
        values(#{apiCase.id},#{apiCase.name},#{apiCase.projectId},#{apiCase.apiCaseSuiteId} , #{apiCase.gmtCreate} , #{apiCase.gmtModified} , #{apiCase.description});
    </insert>

    <update id="updateByID">
        update api_case
        set name = #{apiCase.name} , project_id = #{apiCase.projectId} , api_case_suite_id = #{apiCase.apiCaseSuiteId} , description = #{apiCase.description} , status = #{apiCase.status} , gmt_modified = #{apiCase.gmtModified}
        where id = #{apiCase.id};
    </update>
</mapper>
